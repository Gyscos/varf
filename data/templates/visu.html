 <html>
	<head>
		<title>Varf: {{title}}/{{name}}</title>
		

		<!-- Required Css and js for C3 and D3 plotting -->
		<link href="/static/c3.css" rel="stylesheet" type="text/css">
		<script src="/static/d3.min.js" charset="utf-8"></script>
		<script src="/static/c3.min.js"></script>

		<!-- Boostrap css, and jquery for the js part -->
		<link rel="stylesheet" href="/static/bootstrap.min.css">
		<script src="/static/jquery-2.1.4.min.js"></script>
		<script src="/static/bootstrap.min.js"></script>
        
        <!-- our css. (declared afterward, so that we can override easily ) -->
        <link href="/static/style.css" rel="stylesheet" type="text/css">
		

	</head>

	<body>

		<!-- Navigation bar -->
        <nav class="navbar navbar-default" id="custom_navbar" role="navigation">
            <div class="container-fluid">
                <!-- add a cute bird. Weka has chosen a cute bird from their country (the weka). 
                     Since we are in America ("America, FUCK YEAH!") we choose an eagle, but a cute one -->
                <div class="navbar-header">
                    <a class="navbar-brand" href="#">
                      <img style="height: 45px; margin-top: -8px;" src="/static/eagle.svg">
                    </a>
                    <a class="navbar-brand" href="#">VARF</a>
                </div>
                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="#">Visualization<span class="sr-only">(current)</span></a></li>
                    <li><a href="#">Classify</a></li>
                    <li><a href="#">Feature ranking</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="#">{{filename}}</a></li>
                </ul>
            </div>
        </nav>

        <!-- The list of attributes, filled from the beginning, via template. -->
        <div>
            <div class="panel panel-default attribute_list">
                <div class="title_row panel-heading">
                    <h4>Features</h4>
                </div>
                <div class="row_container">
                    {{#each attributes}}
			        <div class="attribute_row">
                        <div class="attribute_row_index">{{@index}}</div>
                        <div class="attribute_row_content"><a href="/?att_id={{@index}}">{{.}}</a></div>
			        </div>
			        {{/each}}
                </div>
            </div>
        </div>


		<div class="graph">
			<h1>{{name}}</h1>
			<div id="chart"></div>
			{{#if numeric}}
			<div class="dials">
				<form action="/">
					<input type="hidden" name="att_id" value="{{att_id}}">
					<label>Min: <input name="min" value="{{min}}"></label>
					<label>Max: <input name="max" value="{{max}}"></label>
					<label>Precision: <input name="precision" value="{{precision}}"></label>
					<br><br>
					<input type="submit">
				</form>
			</div>
			{{/if}}

			<script>

var id0 = {{#if numeric}}1{{else}}0{{/if}};
var id1 = {{#if numeric}}2{{else}}1{{/if}};
var rows = [];
var labels = [];
{{#if numeric}}
labels.push('x');
{{/if}}
{{#each classes}}
labels.push('{{.}}');
{{/each}}

{{#each classes}}
labels.push('% of {{.}}');
{{/each}}

rows.push(labels);

{{#each samples}}

	var row = [];

	{{#if ../../numeric}}
		row.push("{{label}}");
	{{/if}}

	var sum = 0;
	{{#each slices_len}}
		sum += {{.}};
		row.push({{.}});
	{{/each}}

	{{#each slices_len}}
		row.push({{.}} / sum);
	{{/each}}

	rows.push(row);

{{/each}}

var chart = c3.generate({
	padding: { top: 10, },
	bindto: '#chart',
	data: {
		{{#if numeric}}
		x: 'x',
		{{/if}}
		rows: rows,
		types: {
			{{#each classes}}
			'{{.}}': {{#if ../../numeric}}'area'{{else}}'bar'{{/if}},
			{{/each}}
		},
		axes: {
			{{#each classes}}
				'% of {{.}}': 'y2',
			{{/each}}
		},

		onclick: function(e) {
			// Find out the slice ID
			var slice_id = e.index;
			
			var name = e.name;

			if (name.startsWith("% of"))
				return;

			var url = "/pop?slice="+slice_id+"&class="+name;
			url += "&att_id=" + {{att_id}};
			{{#if numeric}}
				url += "&precision=" + {{precision}};
				url += "&min=" + {{min}};
				url += "&max=" + {{max}};
			{{/if}}

			window.open(url, "_blank");
			
		},
		hide: [
			{{#each classes}}
				{{#unless @first}}
					'% of {{.}}',
				{{/unless}}
			{{/each}}
		],

		groups: [[{{#each classes}}'{{.}}',{{/each}}]]
	},
	axis: {
		y2: {
			padding: {bottom: 0, top: 10},
			min: 0,
			max: 1,
			show: true,
		},
		{{#if numeric}}
		{{else}}
		x: {
			type: 'category',
			categories: [
			{{#each samples}}
				'{{label}}',
			{{/each}}
			]
		},
		{{/if}}
	},
});

			</script>
		</div>
	</body>
</html>

